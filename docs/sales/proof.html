<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#fff7fb" />
    <title>CartGuard | Market Proof</title>
    <meta name="description" content="Source-backed market signals and enforcement pressure supporting APAC to EU compliance workflow demand." />
    <link rel="icon" type="image/svg+xml" href="/CartGuard/assets/logo-mark.svg?v=7" />
    <link rel="alternate icon" href="/CartGuard/assets/favicon.ico?v=7" sizes="any" />
    <link rel="apple-touch-icon" sizes="180x180" href="/CartGuard/assets/apple-touch-icon.png?v=7" />
    <link rel="manifest" href="/CartGuard/site.webmanifest?v=7" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="/CartGuard/styles.css" />
  </head>
  <body class="sales-theme">
    <header class="hero page-hero">
      <nav class="top-nav" aria-label="Sales primary">
        <a href="/CartGuard/sales/" class="nav-brand"><img src="/CartGuard/assets/logo-mark.svg" alt="CartGuard" class="nav-mark" /><span>CartGuard</span></a>
        <div class="nav-links">
          <a href="/CartGuard/sales/">Home</a>
          <a href="/CartGuard/sales/problem.html">Problem</a>
          <a href="/CartGuard/sales/solution.html">Solution</a>
          <a href="/CartGuard/sales/proof.html" aria-current="page">Proof</a>
          <a href="/CartGuard/sales/pilot.html">Pilot</a>
          <a href="/CartGuard/ops/">Ops Manual</a>
                  <button type="button" class="nav-refresh-btn" id="css-hard-refresh">Refresh CSS</button>
        </div>
      </nav>
      <p class="eyebrow">Proof</p>
      <h1>Why this workflow matters now.</h1>
      <p class="lead">Public signals show high APAC-EU flow and rising enforcement pressure, which increases launch-readiness workload.</p>
    </header>

    <main>
      <section class="architecture" aria-label="Stage-safe signals">
        <h2>Stage-Safe Signals</h2>
        <p class="small-note" id="signals-updated">Loading stage-safe signals...</p>
        <div class="table-wrap">
          <table class="comparison-table">
            <thead>
              <tr>
                <th>Signal</th>
                <th>Value</th>
                <th>Confidence</th>
                <th>Evidence</th>
              </tr>
            </thead>
            <tbody id="signals-table-body"></tbody>
          </table>
        </div>
      </section>

      <section class="architecture" aria-label="Pilot outcomes">
        <h2>Pilot Outcomes (Anonymized)</h2>
        <p class="small-note" id="pilots-updated">Loading pilot outcomes...</p>
        <div class="table-wrap">
          <table class="comparison-table">
            <thead>
              <tr>
                <th>Pilot</th>
                <th>Metric</th>
                <th>Baseline</th>
                <th>Current</th>
                <th>Change</th>
                <th>Status</th>
                <th>Evidence</th>
              </tr>
            </thead>
            <tbody id="pilots-table-body"></tbody>
          </table>
        </div>
      </section>

      <section class="pricing" aria-label="What we claim and what we do not claim">
        <h2>What We Claim</h2>
        <ul>
          <li>We recommend what required evidence appears missing.</li>
          <li>We help teams reduce delay and rework in listing workflows.</li>
          <li>We provide measurable pilot metrics for buying decisions.</li>
        </ul>
        <h2>What We Do Not Claim</h2>
        <ul>
          <li>We do not provide legal advice.</li>
          <li>We do not guarantee legal compliance outcomes.</li>
          <li>We do not replace qualified counsel.</li>
        </ul>
      </section>
    </main>

    <footer>
      <p>CartGuard • Proof page</p>
    </footer>
    <script>
      const DATA_ROOT = '/CartGuard/assets/research';
      const signalsUpdatedEl = document.getElementById('signals-updated');
      const signalsTableBodyEl = document.getElementById('signals-table-body');
      const pilotsUpdatedEl = document.getElementById('pilots-updated');
      const pilotsTableBodyEl = document.getElementById('pilots-table-body');

      const escapeHtml = (value) => String(value || '')
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');

      const badgeClass = (confidence) => {
        const c = String(confidence || '').toLowerCase();
        if (c === 'high') return 'status yes';
        if (c === 'medium') return 'status partial';
        return 'status no';
      };

      const fetchJson = async (path, label) => {
        let response;
        try {
          response = await fetch(path, { cache: 'no-store' });
        } catch (error) {
          throw new Error(`${label} network error: ${error && error.message ? error.message : 'request failed'}`);
        }
        if (!response.ok) {
          throw new Error(`${label} unavailable (${response.status}) at ${path}`);
        }
        try {
          return await response.json();
        } catch (error) {
          throw new Error(`${label} parse error: ${error && error.message ? error.message : 'invalid JSON'}`);
        }
      };

      fetchJson(`${DATA_ROOT}/facts.json`, 'Stage-safe signals')
        .then((data) => {
          signalsUpdatedEl.textContent = `Stage-safe signals updated: ${data.updated_at || 'unknown'}`;
          const facts = Array.isArray(data.facts) ? data.facts : [];
          if (facts.length === 0) {
            signalsTableBodyEl.innerHTML = '<tr><td colspan="4">No stage-safe signals yet.</td></tr>';
            return;
          }
          facts.forEach((fact) => {
            const entryHref = `/CartGuard/ops/research.html#entry-${fact.research_entry_id}`;
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${escapeHtml(fact.signal || 'n/a')}</td>
              <td>${escapeHtml(fact.value || fact.claim || 'n/a')}</td>
              <td><span class="${badgeClass(fact.confidence)}">${escapeHtml(fact.confidence || 'low')}</span></td>
              <td><a href="${escapeHtml(fact.source_url || '#')}" target="_blank" rel="noopener noreferrer">Source</a> • <a href="${entryHref}">Research entry</a></td>
            `;
            signalsTableBodyEl.appendChild(row);
          });
        })
        .catch((err) => {
          signalsUpdatedEl.textContent = 'Failed to load stage-safe signals.';
          signalsTableBodyEl.innerHTML = `<tr><td colspan="4">${escapeHtml(err.message)}</td></tr>`;
        });

      fetchJson(`${DATA_ROOT}/pilots.json`, 'Pilot outcomes')
        .then((data) => {
          pilotsUpdatedEl.textContent = `Pilot outcomes updated: ${data.updated_at || 'unknown'}`;
          const pilots = Array.isArray(data.pilots) ? data.pilots : [];
          if (pilots.length === 0) {
            pilotsTableBodyEl.innerHTML = '<tr><td colspan="7">No pilot outcomes yet.</td></tr>';
            return;
          }
          pilots.forEach((pilot) => {
            const entryHref = `/CartGuard/ops/research.html#entry-${pilot.research_entry_id}`;
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${escapeHtml(pilot.pilot_label || 'n/a')}</td>
              <td>${escapeHtml(pilot.metric || 'n/a')}</td>
              <td>${escapeHtml(pilot.baseline || 'n/a')}</td>
              <td>${escapeHtml(pilot.current || 'n/a')}</td>
              <td>${escapeHtml(pilot.improvement || 'n/a')}</td>
              <td>${escapeHtml(pilot.status || 'n/a')}</td>
              <td><a href="${entryHref}">Research entry</a></td>
            `;
            pilotsTableBodyEl.appendChild(row);
          });
        })
        .catch((err) => {
          pilotsUpdatedEl.textContent = 'Failed to load pilot outcomes.';
          pilotsTableBodyEl.innerHTML = `<tr><td colspan="7">${escapeHtml(err.message)}</td></tr>`;
        });
    </script>
    <script id="data-mobile-table-labels">
    (() => {
      const tables = document.querySelectorAll(".comparison-table");
      tables.forEach((table) => {
        const headers = Array.from(table.querySelectorAll("thead th")).map((th) => th.textContent?.trim() || "Field");
        table.querySelectorAll("tbody tr").forEach((row) => {
          Array.from(row.children).forEach((cell, index) => {
            if (cell instanceof HTMLElement) {
              cell.setAttribute("data-label", headers[index] || headers[0] || "Field");
            }
          });
        });
      });
    })();
  </script>
  <script id="css-refresh-script">
    (() => {
      const applyStampToStylesheets = (stamp) => {
        const links = document.querySelectorAll('link[rel="stylesheet"]');
        links.forEach((node) => {
          if (!(node instanceof HTMLLinkElement)) {
            return;
          }
          const url = new URL(node.href, window.location.href);
          url.searchParams.set("css_refresh", stamp);
          node.href = url.toString();
        });
      };

      const pageUrl = new URL(window.location.href);
      const urlStamp = pageUrl.searchParams.get("css_refresh");
      const storedStamp = window.sessionStorage.getItem("cartguard_css_refresh");
      if (urlStamp) {
        applyStampToStylesheets(urlStamp);
      } else if (storedStamp) {
        applyStampToStylesheets(storedStamp);
      }

      const button = document.getElementById("css-hard-refresh");
      if (!(button instanceof HTMLButtonElement)) {
        return;
      }

      const refreshCss = () => {
        const stamp = Date.now().toString();
        window.sessionStorage.setItem("cartguard_css_refresh", stamp);
        applyStampToStylesheets(stamp);
        const nextUrl = new URL(window.location.href);
        nextUrl.searchParams.set("css_refresh", stamp);
        window.location.replace(nextUrl.toString());
      };

      button.addEventListener("click", refreshCss);
    })();
  </script>
</body>
</html>
